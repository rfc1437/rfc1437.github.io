<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="rfc1437">

    <!-- Le styles -->
    <link rel="stylesheet" href="https://rfc1437.github.io/theme/css/bootstrap.min.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="https://rfc1437.github.io/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
        <link href="https://rfc1437.github.io/theme/css/font-awesome.css" rel="stylesheet">

    <link href="https://rfc1437.github.io/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="https://rfc1437.github.io/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://rfc1437.github.io/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://rfc1437.github.io/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://rfc1437.github.io/theme/images/apple-touch-icon-114x114.png">

    <link href="https://rfc1437.github.io/" type="application/atom+xml" rel="alternate" title="Hugo's House of Blog Horror ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="https://rfc1437.github.io/index.html">Hugo's House of Blog Horror </a>
          <div class="nav-collapse">
            <ul class="nav">
                  <li><a href="/impressum.html">Imprint</a></li>
                  <li><a href="/about.html">About</a></li>
                          <li class="divider-vertical"></li>
                  <li class="active">
                    <a href="https://rfc1437.github.io/category/artikel.html">
						<i class="icon-folder-open icon-large"></i>Artikel
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/asides.html">
						<i class="icon-folder-open icon-large"></i>Asides
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/galerie.html">
						<i class="icon-folder-open icon-large"></i>Galerie
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/kochbuch.html">
						<i class="icon-folder-open icon-large"></i>Kochbuch
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/metaowl.html">
						<i class="icon-folder-open icon-large"></i>Metaowl
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/misc.html">
						<i class="icon-folder-open icon-large"></i>misc
					</a>
                  </li>
                  <li >
                    <a href="https://rfc1437.github.io/category/spielelog.html">
						<i class="icon-folder-open icon-large"></i>Spielelog
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="https://rfc1437.github.io/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft">
                                        Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft
                                </a>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2012-03-05T13:47:00+01:00">
        <i class="icon-calendar"></i>Mo 05 März 2012
</abbr>
<span class="label">By</span>
<a href="https://rfc1437.github.io/author/hugo.html"><i class="icon-user"></i>hugo</a>
<span class="label">Category</span>
<a href="https://rfc1437.github.io/category/artikel.html"><i class="icon-folder-open"></i>Artikel</a>.


<span class="label">Tags</span>
	<a href="https://rfc1437.github.io/tag/hyper-v.html"><i class="icon-tag"></i>Hyper-V</a>
	<a href="https://rfc1437.github.io/tag/microsoft.html"><i class="icon-tag"></i>Microsoft</a>
	<a href="https://rfc1437.github.io/tag/sysadmin.html"><i class="icon-tag"></i>Sysadmin</a>
</footer><!-- /.post-info -->                </div>
                <p>Jupp, die obige Kombination ist echt nicht toll. Szenario: Hyper-V Maschine, mehrere virtuelle Maschinen, einige davon mit Snapshots, diverse sehr lange laufende Installationen und viel Arbeit in diesen Maschinen. Neue Maschinen anlegen passiert auf Basis vorhandener Images, die mit sysprep jeweils generalisiert und für Erstnutzung vorbereitet und dann konfiguriert wurden.</p>
<p>Enter the system administrator: eine neue virtuelle Maschine angelegt, sysprep laufen lassen, leider nicht in der virtuellen Maschine, sondern auf dem Hyper-V Server. Der war dann mal weg. Erste Panik-Attacke.</p>
<p>Kollege hat den (von mir natürlich remote stehenden) Hyper-V Server wiederbelebt und in die Domäne gehängt, ich komme drauf. Alle Konfigurationen noch da, alle virtuellen Maschinen noch da. Keine einzige davon funktioniert. Zweite Panik-Attacke.</p>
<p>Virtuelle Maschinen versucht zu editieren, no go - die Konfigurationen sind nicht erreichbar, der Hyper-V denkt, die lägen alle auf Laufwerk C:. Nachgeguckt, oh, die Laufwerke I: und J: (auf denen die Maschinen vorher lagen) sind nicht mehr da, haben andere Buchstaben. Ok, Buchstaben zurückgedreht und Hyper-V neu gestartet. Keine der Maschinen läuft, die glauben immer noch auf C: zu sein. Dritte Panikattacke, als ich merke, dass man keinerlei Konfigurationsänderungen machen kann.</p>
<p>Tja, auch in den Konfigurationen und der Registry findet sich nichts über dieses ominöse C: - wo kommt das her? Nach längerem Suchen gefunden, für jede virtuelle Maschine und für jeden Snapshot legt Hyper-V symbolische Links unter NTFS ab. Diese liegen unter %systemdrive%:\ProgramData\Microsoft\Windows\Hyper-V in den Unterverzeichnissen "Virtual Machines" und "Snapshots" und zeigen auf die echten Zieldateien. Und auf magische Weise zeigten diese alle auf C: - scheinbar "korrigiert" NTFS beim Start defekte symbolische Links, die auf nicht existierende Laufwerke zeigen. Toll.</p>
<p>Also die Links neu angelegt (erstmal nur einen unwichtigen Server, damit ich sehe ob es klappt). Klappt natürlich nicht, weil der Hyper-V ignoriert den schönen neuen symbolischen Link. Rechte sind falsch. Icacls kann das reparieren - "NT VIRTUAL MACHINE\\&lt;guid>" ist die Syntax für den Pseudo-Benutzer den man zuweisen muss. Tut aber nicht. Vierte Panikattacke.</p>
<p>Laut fluchend gefunden, dass ein Franzose damit auch Probleme hatte - Microsoft in seiner großen Weisheit hat die Namen lokalisiert. Unter der deutschen Version also "NT VIRTUELLER COMPUTER\\&lt;guid>". Toll. Ganz Toll. Hat mich ja auch nur 2 Stunden meines Lebens gekostet.</p>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="https://getpelican.com/"><i class="icon-external-link"></i>Pelican</a></li>
    <li><a href="https://www.python.org/"><i class="icon-external-link"></i>Python.org</a></li>
    <li><a href="https://palletsprojects.com/p/jinja/"><i class="icon-external-link"></i>Jinja2</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="https://rfc1437.github.io/feeds/all.atom.xml" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="https://github.com/rfc1437/"><i class="icon-github-sign icon-large"></i>github</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="https://rfc1437.github.io/category/artikel.html">
    <i class="icon-folder-open icon-large"></i>Artikel
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/asides.html">
    <i class="icon-folder-open icon-large"></i>Asides
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/galerie.html">
    <i class="icon-folder-open icon-large"></i>Galerie
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/kochbuch.html">
    <i class="icon-folder-open icon-large"></i>Kochbuch
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/metaowl.html">
    <i class="icon-folder-open icon-large"></i>Metaowl
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/misc.html">
    <i class="icon-folder-open icon-large"></i>misc
</a>
</li>
<li>
<a href="https://rfc1437.github.io/category/spielelog.html">
    <i class="icon-folder-open icon-large"></i>Spielelog
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>


</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is from <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://rfc1437.github.io/theme/js/jquery-1.7.2.min.js"></script>
    <script src="https://rfc1437.github.io/theme/js/bootstrap.min.js"></script>
  </body>
</html>