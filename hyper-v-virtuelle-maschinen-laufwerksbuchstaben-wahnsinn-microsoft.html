<!DOCTYPE html>
<html lang="de-de">
<head>
          <title>Hugo's House of Blog Horror - Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft</title>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <link href="https://rfc1437.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Hugo's House of Blog Horror Full Atom Feed" />
        <link href="https://rfc1437.github.io/feeds/artikel.atom.xml" type="application/atom+xml" rel="alternate" title="Hugo's House of Blog Horror Categories Atom Feed" />




    <meta name="tags" content="Hyper-V" />
    <meta name="tags" content="Microsoft" />
    <meta name="tags" content="Sysadmin" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://rfc1437.github.io/">Hugo's House of Blog Horror</a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/impressum.html">Imprint</a></li>
            <li><a href="/about.html">About</a></li>
            <li class="active"><a href="https://rfc1437.github.io/category/artikel.html">Artikel</a></li>
            <li><a href="https://rfc1437.github.io/category/asides.html">Asides</a></li>
            <li><a href="https://rfc1437.github.io/category/galerie.html">Galerie</a></li>
            <li><a href="https://rfc1437.github.io/category/kochbuch.html">Kochbuch</a></li>
            <li><a href="https://rfc1437.github.io/category/metaowl.html">Metaowl</a></li>
            <li><a href="https://rfc1437.github.io/category/misc.html">misc</a></li>
            <li><a href="https://rfc1437.github.io/category/spielelog.html">Spielelog</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://rfc1437.github.io/hyper-v-virtuelle-maschinen-laufwerksbuchstaben-wahnsinn-microsoft.html" rel="bookmark"
         title="Permalink to Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft">Hyper-V, virtuelle Maschinen, Laufwerksbuchstaben, Wahnsinn, Microsoft</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2012-03-05T13:47:00+01:00">
      Mo 05 März 2012
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://rfc1437.github.io/author/hugo.html">hugo</a>
    </address>
    <div class="category">
        Category: <a href="https://rfc1437.github.io/category/artikel.html">Artikel</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://rfc1437.github.io/tag/hyper-v.html">Hyper-V</a>
            <a href="https://rfc1437.github.io/tag/microsoft.html">Microsoft</a>
            <a href="https://rfc1437.github.io/tag/sysadmin.html">Sysadmin</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Jupp, die obige Kombination ist echt nicht toll. Szenario: Hyper-V Maschine, mehrere virtuelle Maschinen, einige davon mit Snapshots, diverse sehr lange laufende Installationen und viel Arbeit in diesen Maschinen. Neue Maschinen anlegen passiert auf Basis vorhandener Images, die mit sysprep jeweils generalisiert und für Erstnutzung vorbereitet und dann konfiguriert wurden.</p>
<p>Enter the system administrator: eine neue virtuelle Maschine angelegt, sysprep laufen lassen, leider nicht in der virtuellen Maschine, sondern auf dem Hyper-V Server. Der war dann mal weg. Erste Panik-Attacke.</p>
<p>Kollege hat den (von mir natürlich remote stehenden) Hyper-V Server wiederbelebt und in die Domäne gehängt, ich komme drauf. Alle Konfigurationen noch da, alle virtuellen Maschinen noch da. Keine einzige davon funktioniert. Zweite Panik-Attacke.</p>
<p>Virtuelle Maschinen versucht zu editieren, no go - die Konfigurationen sind nicht erreichbar, der Hyper-V denkt, die lägen alle auf Laufwerk C:. Nachgeguckt, oh, die Laufwerke I: und J: (auf denen die Maschinen vorher lagen) sind nicht mehr da, haben andere Buchstaben. Ok, Buchstaben zurückgedreht und Hyper-V neu gestartet. Keine der Maschinen läuft, die glauben immer noch auf C: zu sein. Dritte Panikattacke, als ich merke, dass man keinerlei Konfigurationsänderungen machen kann.</p>
<p>Tja, auch in den Konfigurationen und der Registry findet sich nichts über dieses ominöse C: - wo kommt das her? Nach längerem Suchen gefunden, für jede virtuelle Maschine und für jeden Snapshot legt Hyper-V symbolische Links unter NTFS ab. Diese liegen unter %systemdrive%:\ProgramData\Microsoft\Windows\Hyper-V in den Unterverzeichnissen "Virtual Machines" und "Snapshots" und zeigen auf die echten Zieldateien. Und auf magische Weise zeigten diese alle auf C: - scheinbar "korrigiert" NTFS beim Start defekte symbolische Links, die auf nicht existierende Laufwerke zeigen. Toll.</p>
<p>Also die Links neu angelegt (erstmal nur einen unwichtigen Server, damit ich sehe ob es klappt). Klappt natürlich nicht, weil der Hyper-V ignoriert den schönen neuen symbolischen Link. Rechte sind falsch. Icacls kann das reparieren - "NT VIRTUAL MACHINE\\&lt;guid>" ist die Syntax für den Pseudo-Benutzer den man zuweisen muss. Tut aber nicht. Vierte Panikattacke.</p>
<p>Laut fluchend gefunden, dass ein Franzose damit auch Probleme hatte - Microsoft in seiner großen Weisheit hat die Namen lokalisiert. Unter der deutschen Version also "NT VIRTUELLER COMPUTER\\&lt;guid>". Toll. Ganz Toll. Hat mich ja auch nur 2 Stunden meines Lebens gekostet.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>